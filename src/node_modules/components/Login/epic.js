import { Observable } from 'rxjs';
import { ajax } from 'rxjs/ajax';
import { mergeMap, map } from 'rxjs/operators';
import { combineEpics, ofType } from 'redux-observable';
import axios from 'axios';

import { serialize, handleError } from './../../api_helper';

import * as actionsTypes from './constants';

import { receiveLogIn, cancelLogIn } from './actions';

const logInEpic = (action$) => action$.pipe(
    ofType(actionsTypes.LOG_IN),
    mergeMap(action => ajax.post(action.payload.url, serialize(action.payload.data)).pipe(
      map(response => receiveLogIn(response))
    ))
  );


export default combineEpics(
  logInEpic
);